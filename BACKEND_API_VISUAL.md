# ğŸ¯ Backend API KommunikÃ¡ciÃ³ - VizuÃ¡lis MagyarÃ¡zat

## ğŸ“Š Teljes Rendszer Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT (Browser)                                â”‚
â”‚                     Vue.js App (localhost:5174)                          â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Vue Component (pl. LoginPage.vue)                              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  <script setup>                                                 â”‚   â”‚
â”‚  â”‚    const handleLogin = async () => {                           â”‚   â”‚
â”‚  â”‚      await authStore.login({ email, password })                â”‚   â”‚
â”‚  â”‚    }                                                            â”‚   â”‚
â”‚  â”‚  </script>                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Pinia Store (stores/auth.js)                                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  actions: {                                                     â”‚   â”‚
â”‚  â”‚    async login(credentials) {                                   â”‚   â”‚
â”‚  â”‚      const response = await api.login(credentials)             â”‚   â”‚
â”‚  â”‚      this.setAuth(response.data)                               â”‚   â”‚
â”‚  â”‚    }                                                            â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  API Service (services/api.js)                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  import axios from 'axios'                                      â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  const apiClient = axios.create({                              â”‚   â”‚
â”‚  â”‚    baseURL: 'http://127.0.0.1:8000/api'                       â”‚   â”‚
â”‚  â”‚  })                                                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  // Request Interceptor                                         â”‚   â”‚
â”‚  â”‚  apiClient.interceptors.request.use(config => {                â”‚   â”‚
â”‚  â”‚    const token = localStorage.getItem('auth_token')           â”‚   â”‚
â”‚  â”‚    if (token) {                                                 â”‚   â”‚
â”‚  â”‚      config.headers.Authorization = `Bearer ${token}`         â”‚   â”‚
â”‚  â”‚    }                                                            â”‚   â”‚
â”‚  â”‚    return config                                                â”‚   â”‚
â”‚  â”‚  })                                                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  export default {                                               â”‚   â”‚
â”‚  â”‚    login(data) {                                               â”‚   â”‚
â”‚  â”‚      return apiClient.post('/login', data)                    â”‚   â”‚
â”‚  â”‚    }                                                            â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP Request
                               â”‚ POST /api/login
                               â”‚ Headers: {
                               â”‚   Content-Type: application/json,
                               â”‚   Accept: application/json,
                               â”‚   Authorization: Bearer token (ha van)
                               â”‚ }
                               â”‚ Body: { email, password }
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       SERVER (Laravel Backend)                           â”‚
â”‚                      http://127.0.0.1:8000                               â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  1ï¸âƒ£  Entry Point: public/index.php                            â”‚    â”‚
â”‚  â”‚      â””â”€ Bootstrap Laravel Application                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  2ï¸âƒ£  HTTP Kernel                                              â”‚    â”‚
â”‚  â”‚      â””â”€ Global Middleware Stack                                â”‚    â”‚
â”‚  â”‚         â”œâ”€ CORS Middleware âœ…                                  â”‚    â”‚
â”‚  â”‚         â”‚  â””â”€ Access-Control-Allow-Origin: *                  â”‚    â”‚
â”‚  â”‚         â”œâ”€ JSON Request Middleware                             â”‚    â”‚
â”‚  â”‚         â””â”€ Error Handling                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  3ï¸âƒ£  Router (routes/api.php)                                  â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  Route::post('/login', [AuthController::class, 'login']);    â”‚    â”‚
â”‚  â”‚                           â”‚                                     â”‚    â”‚
â”‚  â”‚                           â””â”€ URL Match: /api/login            â”‚    â”‚
â”‚  â”‚                              Method: POST âœ…                    â”‚    â”‚
â”‚  â”‚                              Controller: AuthController        â”‚    â”‚
â”‚  â”‚                              Action: login                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  4ï¸âƒ£  Middleware: auth:sanctum (vÃ©dett route-oknÃ¡l)           â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  if (vÃ©dett route) {                                           â”‚    â”‚
â”‚  â”‚    â”œâ”€ Extract Bearer Token from Header                        â”‚    â”‚
â”‚  â”‚    â”‚  Authorization: "Bearer 1|abc123..."                     â”‚    â”‚
â”‚  â”‚    â”‚                                                            â”‚    â”‚
â”‚  â”‚    â”œâ”€ Query Database: personal_access_tokens                  â”‚    â”‚
â”‚  â”‚    â”‚  WHERE token = HASH('abc123...')                         â”‚    â”‚
â”‚  â”‚    â”‚                                                            â”‚    â”‚
â”‚  â”‚    â”œâ”€ Load User                                                â”‚    â”‚
â”‚  â”‚    â”‚  $user = User::find($token->tokenable_id)               â”‚    â”‚
â”‚  â”‚    â”‚                                                            â”‚    â”‚
â”‚  â”‚    â””â”€ Attach to Request                                        â”‚    â”‚
â”‚  â”‚       $request->user = $user                                   â”‚    â”‚
â”‚  â”‚  }                                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  5ï¸âƒ£  Controller (app/Http/Controllers/Api/AuthController.php)â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  class AuthController extends Controller                       â”‚    â”‚
â”‚  â”‚  {                                                              â”‚    â”‚
â”‚  â”‚      public function login(Request $request)                   â”‚    â”‚
â”‚  â”‚      {                                                          â”‚    â”‚
â”‚  â”‚          // A. Request Validation                              â”‚    â”‚
â”‚  â”‚          $validated = $request->validate([                     â”‚    â”‚
â”‚  â”‚              'email' => 'required|email',                      â”‚    â”‚
â”‚  â”‚              'password' => 'required'                          â”‚    â”‚
â”‚  â”‚          ]);                                                    â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚          // Ha validation fail â†’ 422 Response âŒ               â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚          // B. Business Logic                                  â”‚    â”‚
â”‚  â”‚          $user = User::where('email', $request->email)        â”‚    â”‚
â”‚  â”‚                      ->first();                                â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚          if (!$user || !Hash::check($password)) {             â”‚    â”‚
â”‚  â”‚              throw ValidationException::withMessages([        â”‚    â”‚
â”‚  â”‚                  'email' => ['Invalid credentials']           â”‚    â”‚
â”‚  â”‚              ]);                                               â”‚    â”‚
â”‚  â”‚          }                                                      â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚          // C. Token Generation                                â”‚    â”‚
â”‚  â”‚          $token = $user->createToken('auth_token')            â”‚    â”‚
â”‚  â”‚                        ->plainTextToken;                       â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚          // D. JSON Response                                   â”‚    â”‚
â”‚  â”‚          return response()->json([                             â”‚    â”‚
â”‚  â”‚              'user' => $user,                                  â”‚    â”‚
â”‚  â”‚              'token' => $token                                 â”‚    â”‚
â”‚  â”‚          ], 200);                                              â”‚    â”‚
â”‚  â”‚      }                                                          â”‚    â”‚
â”‚  â”‚  }                                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  6ï¸âƒ£  Model (app/Models/User.php)                             â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  use Laravel\Sanctum\HasApiTokens;                            â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  class User extends Authenticatable                            â”‚    â”‚
â”‚  â”‚  {                                                              â”‚    â”‚
â”‚  â”‚      use HasApiTokens;  // â† Token methods                    â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚      // createToken() method available                         â”‚    â”‚
â”‚  â”‚  }                                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  7ï¸âƒ£  Database (SQLite/MySQL)                                  â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  users table:                                                   â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ id â”‚ name        â”‚ email            â”‚ pass   â”‚ role    â”‚  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚
â”‚  â”‚  â”‚ 1  â”‚ Test Guest  â”‚ guest@test.com   â”‚ $hash  â”‚ guest   â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  personal_access_tokens table:                                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ id â”‚ tokenable   â”‚ name â”‚ token  â”‚ created_at          â”‚  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚
â”‚  â”‚  â”‚ 1  â”‚ User:1      â”‚ auth â”‚ hash   â”‚ 2025-11-25 10:00:00 â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                â”‚                                         â”‚
â”‚                                â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  8ï¸âƒ£  HTTP Response                                            â”‚    â”‚
â”‚  â”‚                                                                 â”‚    â”‚
â”‚  â”‚  Status: 200 OK                                                â”‚    â”‚
â”‚  â”‚  Headers: {                                                     â”‚    â”‚
â”‚  â”‚    Content-Type: application/json,                             â”‚    â”‚
â”‚  â”‚    Access-Control-Allow-Origin: *                              â”‚    â”‚
â”‚  â”‚  }                                                              â”‚    â”‚
â”‚  â”‚  Body: {                                                        â”‚    â”‚
â”‚  â”‚    "user": {                                                    â”‚    â”‚
â”‚  â”‚      "id": 1,                                                   â”‚    â”‚
â”‚  â”‚      "name": "Test Guest",                                      â”‚    â”‚
â”‚  â”‚      "email": "guest@test.com",                                â”‚    â”‚
â”‚  â”‚      "role": "guest"                                            â”‚    â”‚
â”‚  â”‚    },                                                           â”‚    â”‚
â”‚  â”‚    "token": "1|abc123def456..."                               â”‚    â”‚
â”‚  â”‚  }                                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP Response
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT (Browser)                                â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Axios Response Interceptor                                      â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  apiClient.interceptors.response.use(                           â”‚   â”‚
â”‚  â”‚    response => response,  // Success âœ…                         â”‚   â”‚
â”‚  â”‚    error => {                                                    â”‚   â”‚
â”‚  â”‚      if (error.response?.status === 401) {                      â”‚   â”‚
â”‚  â”‚        // Token invalid/expired                                 â”‚   â”‚
â”‚  â”‚        localStorage.clear()                                      â”‚   â”‚
â”‚  â”‚        window.location.href = '/login'                          â”‚   â”‚
â”‚  â”‚      }                                                           â”‚   â”‚
â”‚  â”‚      return Promise.reject(error)                               â”‚   â”‚
â”‚  â”‚    }                                                             â”‚   â”‚
â”‚  â”‚  )                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Pinia Store - Process Response                                 â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  setAuth(data) {                                                â”‚   â”‚
â”‚  â”‚    this.user = data.user                                        â”‚   â”‚
â”‚  â”‚    this.token = data.token                                      â”‚   â”‚
â”‚  â”‚    this.isAuthenticated = true                                  â”‚   â”‚
â”‚  â”‚    localStorage.setItem('user', JSON.stringify(user))          â”‚   â”‚
â”‚  â”‚    localStorage.setItem('auth_token', token)                   â”‚   â”‚
â”‚  â”‚  }                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Vue Component - UI Update                                       â”‚   â”‚
â”‚  â”‚                                                                   â”‚   â”‚
â”‚  â”‚  âœ… Login successful!                                           â”‚   â”‚
â”‚  â”‚  âœ… NavBar updated: "Test Guest" + Logout button               â”‚   â”‚
â”‚  â”‚  âœ… Redirect to Home                                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request-Response Ciklus RÃ©szletesen

### 1ï¸âƒ£ Frontend â†’ Backend (Request)

```javascript
// Frontend: api.login({ email, password })
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HTTP POST Request                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ URL: /api/login                     â”‚
â”‚ Method: POST                        â”‚
â”‚ Headers:                            â”‚
â”‚   Content-Type: application/json   â”‚
â”‚   Accept: application/json          â”‚
â”‚   Authorization: Bearer ... (ha van)â”‚
â”‚ Body:                               â”‚
â”‚   {                                 â”‚
â”‚     "email": "guest@test.com",     â”‚
â”‚     "password": "password"          â”‚
â”‚   }                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ Backend Processing

```
Laravel Backend
â”‚
â”œâ”€ 1. CORS Check
â”‚  â””â”€ Origin: http://localhost:5174 â†’ âœ… Allowed
â”‚
â”œâ”€ 2. Route Match
â”‚  â””â”€ POST /api/login â†’ AuthController@login
â”‚
â”œâ”€ 3. Validation
â”‚  â”œâ”€ email: required|email â†’ âœ…
â”‚  â””â”€ password: required â†’ âœ…
â”‚
â”œâ”€ 4. Database Query
â”‚  â””â”€ SELECT * FROM users WHERE email = 'guest@test.com'
â”‚     Result: User found âœ…
â”‚
â”œâ”€ 5. Password Check
â”‚  â””â”€ Hash::check('password', $user->password)
â”‚     Result: Match âœ…
â”‚
â”œâ”€ 6. Token Creation
â”‚  â”œâ”€ Generate random token
â”‚  â”œâ”€ Hash token
â”‚  â”œâ”€ INSERT INTO personal_access_tokens
â”‚  â””â”€ Return plain token: "1|abc123..."
â”‚
â””â”€ 7. JSON Response
   â””â”€ { user, token }
```

### 3ï¸âƒ£ Backend â†’ Frontend (Response)

```javascript
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HTTP Response                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status: 200 OK                      â”‚
â”‚ Headers:                            â”‚
â”‚   Content-Type: application/json   â”‚
â”‚   Access-Control-Allow-Origin: *    â”‚
â”‚ Body:                               â”‚
â”‚   {                                 â”‚
â”‚     "user": {                       â”‚
â”‚       "id": 1,                      â”‚
â”‚       "name": "Test Guest",         â”‚
â”‚       "email": "guest@test.com",   â”‚
â”‚       "role": "guest"               â”‚
â”‚     },                              â”‚
â”‚     "token": "1|abc123def456..."   â”‚
â”‚   }                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4ï¸âƒ£ Frontend Processing

```javascript
// Response handling
const response = await api.login(credentials);
// response.data = { user, token }

// Store in Pinia
authStore.setAuth(response.data);

// Store in localStorage
localStorage.setItem("auth_token", response.data.token);
localStorage.setItem("user", JSON.stringify(response.data.user));

// Update UI
router.push({ name: "Home" });
```

---

## ğŸ” Token Ã‰letciklus

```
1ï¸âƒ£  Token Generation (Backend)
    â”‚
    â”œâ”€ User login/register
    â”œâ”€ $user->createToken('auth_token')
    â”‚  â”‚
    â”‚  â”œâ”€ Generate random string
    â”‚  â”œâ”€ Create hash
    â”‚  â””â”€ Store in personal_access_tokens table
    â”‚
    â””â”€ Return: "1|abc123def456..." (plain text token)

2ï¸âƒ£  Token Storage (Frontend)
    â”‚
    â””â”€ localStorage.setItem('auth_token', token)

3ï¸âƒ£  Token Usage (Every API Request)
    â”‚
    â”œâ”€ Axios interceptor reads from localStorage
    â”œâ”€ Adds to request header:
    â”‚  Authorization: Bearer 1|abc123...
    â”‚
    â””â”€ Backend validates:
       â”œâ”€ Extract token
       â”œâ”€ Hash and lookup in database
       â””â”€ Load user if valid

4ï¸âƒ£  Token Deletion (Logout)
    â”‚
    â”œâ”€ Backend: DELETE FROM personal_access_tokens
    â””â”€ Frontend: localStorage.removeItem('auth_token')
```

---

## âœ… Backend API KommunikÃ¡ciÃ³ Ã–sszefoglalÃ³

### Kulcs Komponensek:

1. **Routes** (`routes/api.php`)

   - URL mapping
   - Middleware assignment

2. **Controllers** (`app/Http/Controllers/Api/`)

   - Request handling
   - Business logic
   - Response formatting

3. **Middleware** (`auth:sanctum`)

   - Token validation
   - User authentication

4. **Models** (`app/Models/`)

   - Database interactions
   - Eloquent ORM

5. **Validation**

   - Input sanitization
   - Business rules

6. **CORS** (`config/cors.php`)
   - Cross-origin requests
   - Security headers

### KommunikÃ¡ciÃ³s Folyamat:

```
Request â†’ CORS â†’ Router â†’ Middleware â†’ Controller â†’ Model â†’ Database
                                                              â†“
                                                        Query Result
                                                              â†“
Response â† JSON â† Controller â† Business Logic â† Data Processing
```

---

**Most mÃ¡r Ã©rted, hogyan mÅ±kÃ¶dik a backend API kommunikÃ¡ciÃ³! ğŸš€**
